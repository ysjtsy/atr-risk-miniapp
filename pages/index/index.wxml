<view class="container">

<!-- 交易对选择 -->
<view class="section">
  <view class="label">交易对</view>
  <picker mode="selector" range="{{symbolOptions}}" bindchange="onSymbolSelect">
    <view class="picker">当前：{{symbol}}</view>
  </picker>
</view>

<!-- 最新价格 -->
<view class="section">
  <view class="label">最新价格</view>

  <view class="price-grid">
    <view class="price-item">
      <view class="price-title">现货</view>
      <view class="price-value">{{spotPrice || '-'}}</view>
    </view>
    <view class="price-item">
      <view class="price-title">合约</view>
      <view class="price-value">{{futuresPrice || '-'}}</view>
    </view>
    <view class="price-item">
      <view class="price-title">合约 - 现货</view>
      <view class="price-value">{{priceDiff || '-'}}</view>
    </view>
  </view>

  <view class="price-actions">
    <button class="mini-btn" size="mini" bindtap="refreshPrices">
      刷新价格
    </button>
    <button class="mini-btn" size="mini" bindtap="onUseFuturesPrice">
      用合约价填入开仓价
    </button>
  </view>
</view>

<!-- K线周期（用于 ATR） -->
<view class="section">
  <view class="label">K线周期（ATR 使用此周期）</view>
  <picker mode="selector" range="{{intervalOptions}}" bindchange="onIntervalSelect">
    <view class="picker">当前：{{interval}}</view>
  </picker>
</view>

<!-- ATR 周期 -->
<view class="section">
  <view class="label">ATR 周期</view>
  <input
    type="number"
    value="{{atrPeriodInput}}"
    placeholder="14"
    bindinput="onAtrPeriodInput"
  />
</view>

<!-- ATR 倍数 -->
<view class="section">
  <view class="label">ATR 倍数（例如 1.5）</view>
  <input
    type="digit"
    value="{{atrMultInput}}"
    placeholder="1.5"
    bindinput="onAtrMultInput"
  />
</view>

<!-- 开仓方向 -->
<view class="section">
  <view class="label">开仓方向</view>
  <picker mode="selector" range="{{directionOptions}}" bindchange="onDirectionChange">
    <view class="picker">
      当前：{{direction === 'long' ? '多单' : '空单'}}
    </view>
  </picker>
</view>

<!-- 开仓价 -->
<view class="section">
  <view class="label">开仓价（Entry Price）</view>
  <input
    type="digit"
    value="{{entryPriceInput}}"
    placeholder="请输入开仓价或点击“用合约价填入开仓价”"
    bindinput="onEntryPriceInput"
  />
</view>

<!-- 按钮 -->
<button class="btn" bindtap="onCalcTap" loading="{{loading}}">
  计算 ATR 与止损建议
</button>

<!-- 结果 -->
<view class="result" wx:if="{{atr}}">
  <view>ATR{{atrPeriodInput}}：{{atr}}</view>
  <view>开仓价：{{entryPriceInput}}</view>
  <view wx:if="{{direction === 'long'}}">
    建议止损价（多单）：{{stopLossPrice}}
  </view>
  <view wx:if="{{direction === 'short'}}">
    建议止损价（空单）：{{stopLossPrice}}
  </view>
</view>

<view class="error" wx:if="{{error}}">
  {{error}}
</view>

</view>